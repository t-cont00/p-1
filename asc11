function doGet(e) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  const data = sheet.getDataRange().getValues();
  const headers = data.shift();

  // Pick a random row (ignoring header)
  const randomRow = data[Math.floor(Math.random() * data.length)];

  const question = {
    id: randomRow[0],
    question: randomRow[1],
    options: [randomRow[2], randomRow[3], randomRow[4], randomRow[5]],
    correctAnswer: randomRow[6].split(","),
    isMulti: randomRow[7] === true
  };

  return HtmlService.createHtmlOutput(renderForm(question));
}


function renderForm(q) {
  let html = `
    <html>
      <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #f5f5f5;
          }
          .container {
            width: 90%;
            max-width: 500px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            text-align: center;
          }
          /* Improve responsiveness on small screens */
          @media (max-width: 600px) {
            .container {
              width: 95%;
              padding: 15px;
            }
          }
          .container h2 {
            font-size: 1.2rem;
            margin-bottom: 20px;
          }
          label {
            display: block;
            margin: 10px 0;
            text-align: left;
          }
          .result {
            font-size: 1.5rem;
            margin-top: 20px;
            display: none;
            animation: fadeIn 0.5s ease-in-out;
          }
          .tick {
            color: green;
            font-size: 2.5rem;
          }
          .cross {
            color: red;
            font-size: 2.5rem;
          }
          .correct-animate {
            background: #d4edda !important;
            transition: background 0.5s ease;
          }
          .incorrect-animate {
            background: #f8d7da !important;
            transition: background 0.5s ease;
          }
          @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
          }
        </style>
      </head>
      <body>
        <div class="container" id="quizContainer">
          <h2>${q.question}</h2>
          <form id="quizForm" onsubmit="return checkAnswer();">
  `;
  
  q.options.forEach((opt, index) => {
    const inputType = q.isMulti ? "checkbox" : "radio";
    html += `<label><input type="${inputType}" name="opt" value="${String.fromCharCode(65 + index)}"> ${opt}</label>`;
  });
  
  html += `
            <br><input type="submit" value="Submit">
          </form>
          <div id="result" class="result"></div>
        </div>
  
        <script>
           
          function checkAnswer() {
            const form = document.getElementById('quizForm');
            const selected = Array.from(form.elements['opt'])
                              .filter(el => el.checked || el.selected)
                              .map(el => el.value);
            const correct = ${JSON.stringify(q.correctAnswer)};
            const result = document.getElementById('result');
            const container = document.getElementById('quizContainer');
  
            const isCorrect = selected.length === correct.length &&
                              selected.every(val => correct.includes(val));
  
            form.style.display = 'none';
  
            if (isCorrect) {
              result.innerHTML = "<div class='tick'>✅</div><div>Correct!</div>";
              container.classList.add("correct-animate");
            } else {
              result.innerHTML = "<div class='cross'>❌</div><div>Incorrect</div>";
              container.classList.add("incorrect-animate");
            }
  
            result.style.display = "block";
            return false;
          }
        </script>
      </body>
    </html>
  `;
  return html;
}


--------------

ID	Question	Option A	Option B	Option C	Option D	Correct Answer	Is Multi
1	Which planet is known as the Red Planet?	Earth	Venus	Mars	Jupiter	C	FALSE
2	Select the prime numbers.	2	3	4	5	A, B, D	TRUE
3	What is the capital of France?	Paris	Berlin	Rome	Madrid	A	FALSE
4	Which are programming languages?	Python	Snake	Java	Elephant	A,C	TRUE
5	What is the result of 3 + 5?	5	7	8	9	C	FALSE
6	Which are Indian states?	Goa	Paris	Kerala	New yourk	A,C	TRUE
7	The boiling point of water is?	90 C	100 C	80 C	70 C	B	FALSE
8	Select web technologies.	HTML	CSS	SQL	Football	A,B,C	TRUE
9	Who wrote the Harry Potter series?	J.K. Rowling	J.R.R. Tolkien	George Orwell	C.S. Lewis	A	FALSE
10	Which are mammals?	Shark	Whale	Dolphin	Frog	B,C	TRUE
